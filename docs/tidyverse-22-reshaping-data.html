<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 Tidyverse 2/2: reshaping data | DLL 2021, R section</title>
  <meta name="description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 Tidyverse 2/2: reshaping data | DLL 2021, R section" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="github-repo" content="darachm/dll-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 Tidyverse 2/2: reshaping data | DLL 2021, R section" />
  
  <meta name="twitter:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  

<meta name="author" content="mesako" />
<meta name="author" content="Margaret" />
<meta name="author" content="Samson" />
<meta name="author" content="Zac" />
<meta name="author" content="darachm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tidyverse-12-functions-pipes.html"/>
<link rel="next" href="making-plots-with-ggplot2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DLL 2021 R workshops</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workshop Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="workshop-goals.html"><a href="workshop-goals.html"><i class="fa fa-check"></i><b>1.1</b> Workshop goals</a></li>
<li class="chapter" data-level="1.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html"><i class="fa fa-check"></i><b>1.2</b> Structure and resources</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="structure-and-resources.html"><a href="structure-and-resources.html#workshop-schedule"><i class="fa fa-check"></i><b>1.2.1</b> Workshop schedule</a></li>
<li class="chapter" data-level="1.2.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html#asynchronous-sessions"><i class="fa fa-check"></i><b>1.2.2</b> Asynchronous sessions</a></li>
<li class="chapter" data-level="1.2.3" data-path="structure-and-resources.html"><a href="structure-and-resources.html#synchronous-sessions"><i class="fa fa-check"></i><b>1.2.3</b> Synchronous sessions</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="workshop-expectations.html"><a href="workshop-expectations.html"><i class="fa fa-check"></i><b>1.3</b> Workshop expectations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-4---tidyverse-and-visualizations.html"><a href="day-4---tidyverse-and-visualizations.html"><i class="fa fa-check"></i><b>2</b> Day 4 - tidyverse and visualizations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html"><i class="fa fa-check"></i><b>2.1</b> Reading and processing data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html#loading-a-file-into-r"><i class="fa fa-check"></i><b>2.1.1</b> Loading a file into R</a></li>
<li class="chapter" data-level="2.1.2" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html#handling-issues-in-data"><i class="fa fa-check"></i><b>2.1.2</b> Handling issues in data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html"><i class="fa fa-check"></i><b>2.2</b> Tidyverse 1/2: functions &amp; pipes</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>2.2.1</b> Welcome to the tidyverse!</a></li>
<li class="chapter" data-level="2.2.2" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#load-tidyverse"><i class="fa fa-check"></i><b>2.2.2</b> Load tidyverse</a></li>
<li class="chapter" data-level="2.2.3" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#how-to-pipe"><i class="fa fa-check"></i><b>2.2.3</b> How to pipe %&gt;%</a></li>
<li class="chapter" data-level="2.2.4" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#essential-tidyverse-functions"><i class="fa fa-check"></i><b>2.2.4</b> Essential tidyverse functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html"><i class="fa fa-check"></i><b>2.3</b> Tidyverse 2/2: reshaping data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#why-tidy-data"><i class="fa fa-check"></i><b>2.3.1</b> Why tidy data</a></li>
<li class="chapter" data-level="2.3.2" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#how-to-tidy-data"><i class="fa fa-check"></i><b>2.3.2</b> How to tidy data</a></li>
<li class="chapter" data-level="2.3.3" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#data-exploration-with-tidyverse"><i class="fa fa-check"></i><b>2.3.3</b> Data exploration with tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>2.4</b> Making plots with ggplot2</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#getting-started-with-a-ggplot"><i class="fa fa-check"></i><b>2.4.1</b> Getting started with a ggplot</a></li>
<li class="chapter" data-level="2.4.2" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#changing-plot-aesthetics"><i class="fa fa-check"></i><b>2.4.2</b> Changing plot aesthetics</a></li>
<li class="chapter" data-level="2.4.3" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#exploring-simple-plots"><i class="fa fa-check"></i><b>2.4.3</b> Exploring simple plots</a></li>
<li class="chapter" data-level="2.4.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#visualizing-between-groups"><i class="fa fa-check"></i><b>2.4.4</b> Visualizing between groups</a></li>
<li class="chapter" data-level="2.4.5" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#generating-heatmaps-optional"><i class="fa fa-check"></i><b>2.4.5</b> Generating heatmaps (OPTIONAL)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html"><i class="fa fa-check"></i><b>2.5</b> Making scientific figures</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#plotting-error-bars"><i class="fa fa-check"></i><b>2.5.1</b> Plotting error bars</a></li>
<li class="chapter" data-level="2.5.2" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#showing-trends-in-data"><i class="fa fa-check"></i><b>2.5.2</b> Showing trends in data</a></li>
<li class="chapter" data-level="2.5.3" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#saving-figures-locally"><i class="fa fa-check"></i><b>2.5.3</b> Saving figures locally</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html"><i class="fa fa-check"></i><b>2.6</b> Applying basic stats</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#describing-quantitative-variables"><i class="fa fa-check"></i><b>2.6.1</b> Describing quantitative variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#finding-differences-in-data"><i class="fa fa-check"></i><b>2.6.2</b> Finding differences in data</a></li>
<li class="chapter" data-level="2.6.3" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#identifying-correlations"><i class="fa fa-check"></i><b>2.6.3</b> Identifying correlations</a></li>
<li class="chapter" data-level="2.6.4" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#producing-linear-models"><i class="fa fa-check"></i><b>2.6.4</b> Producing linear models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>3</b> Appendix</a>
<ul>
<li class="chapter" data-level="3.1" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html"><i class="fa fa-check"></i><b>3.1</b> Some links and some extras</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html#ideas-for-figures"><i class="fa fa-check"></i><b>3.1.1</b> Ideas for figures</a></li>
<li class="chapter" data-level="3.1.2" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html#more-links"><i class="fa fa-check"></i><b>3.1.2</b> More links</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DLL 2021, R section</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyverse-22-reshaping-data" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Tidyverse 2/2: reshaping data<a href="tidyverse-22-reshaping-data.html#tidyverse-22-reshaping-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Goal: Understand when reshaping a dataframe is necessary and how to do it using tidyverse functions <code>gather()</code> and <code>spread()</code></p>
<div id="why-tidy-data" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Why tidy data<a href="tidyverse-22-reshaping-data.html#why-tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far we’ve used two datasets: <code>irisz</code> and <code>msleep</code>. Even though there is some missing data in these datasets, for the most part, they are quite neat. Notice how each line represents a single observation and each column represents a single variable. There is no redundancy in the rows or columns. Sometimes datasets will have columns with columns that mean the same thing but apply to only certain subsets of the data. Columns like this can be collapsed.</p>
<p>On the other hand, sometimes data will be recorded together in the same column, when they are in fact two different types of data. Imagine if conservation status in the <code>msleep</code> dataset were appended to the name. If we wanted to perform an analysis based on conservation status, we would need to tidy that up by making sure it’s in a separate columns.</p>
</div>
<div id="how-to-tidy-data" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> How to tidy data<a href="tidyverse-22-reshaping-data.html#how-to-tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The reality is that datasets don’t always come in neat format. Before and during data analysis, we will often need to “tidy” datasets. tidyverse has 4 important functions for tidying data:</p>
<ul>
<li><code>gather()</code>: change data from a wide to long format - i.e. reduce extra columns</li>
<li><code>spread()</code>: change data from a long to wide format - i.e. expand a column into multiple columns</li>
<li><code>separate()</code>: spearate a column into 2 or more columns based on a pattern or delimeter</li>
<li><code>unite()</code>: unite multiple columns into 1</li>
</ul>
<p>In lieu of re-inventing the wheel, here’s an excellent explanation and illustration of the concept of tidy data and how to apply these functions to make data tidy.</p>
<p><strong>Read this excerpt from Data Science in R by Garret Grolemand <a href="https://garrettgman.github.io/tidying/" class="uri">https://garrettgman.github.io/tidying/</a></strong></p>
<p>For the asynchronous portion, let’s apply these principles and functions to a new dataset. I’ll set up a few example datasets based on the original. Answer the questions starting from the appropriate example dataset (e.g. <code>df_1</code>, <code>df_2</code>, <code>df_3</code>).</p>
</div>
<div id="data-exploration-with-tidyverse" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Data exploration with tidyverse<a href="tidyverse-22-reshaping-data.html#data-exploration-with-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>The dataset: New York Times COVID-19 cases</strong></p>
<p>Even though we’re just using this dataset to learn about tidyverse, it’s always important to read about the dataset. Downloading data can be difficult and we don’t want to dive into that if the data is not what we want. So always read about it first! Read the <a href="https://github.com/nytimes/covid-19-data">introduction on Github</a>. Based on the description of the dataset, try to answer these questions: (no need to look at the actual data, the description should be sufficient)</p>
<ol style="list-style-type: decimal">
<li>Why was this data collected?</li>
<li>When was the data last updated?</li>
<li>What kind of data is it? Is it genetic data, imaging data, text data? Is it descriptive, numeric, categorical?</li>
<li>How was the data collected? One or many sources?</li>
<li>Are there imperfections in the data? Limitations? E.g. missing data, different data meanings?</li>
</ol>
<p>We’ll read in the data straight from github. This is a lot of data (every county in the U.S.) so to make it more manageable downstream, we’ll filter the dataset to only include:</p>
<ol style="list-style-type: decimal">
<li>A few states: California, Washington, Illinois, Nebraska, and Florida. Feel free to add your own state!</li>
<li>The last total count of cases and deaths</li>
</ol>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.3.5     ✔ purrr   0.3.4
## ✔ tibble  3.1.6     ✔ dplyr   1.0.8
## ✔ tidyr   1.2.0     ✔ stringr 1.4.0
## ✔ readr   2.1.2     ✔ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="tidyverse-22-reshaping-data.html#cb94-1" aria-hidden="true" tabindex="-1"></a>data_url <span class="ot">=</span> <span class="st">&quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span></span>
<span id="cb94-2"><a href="tidyverse-22-reshaping-data.html#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="tidyverse-22-reshaping-data.html#cb94-3" aria-hidden="true" tabindex="-1"></a>favorite_states <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;California&quot;</span>, <span class="st">&quot;Washington&quot;</span>, <span class="st">&quot;Illinois&quot;</span>, <span class="st">&quot;Nebraska&quot;</span>,  <span class="st">&quot;Florida&quot;</span>)</span>
<span id="cb94-4"><a href="tidyverse-22-reshaping-data.html#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="tidyverse-22-reshaping-data.html#cb94-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data_url,</span>
<span id="cb94-6"><a href="tidyverse-22-reshaping-data.html#cb94-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">header =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb94-7"><a href="tidyverse-22-reshaping-data.html#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">%in%</span> favorite_states) <span class="sc">%&gt;%</span></span>
<span id="cb94-8"><a href="tidyverse-22-reshaping-data.html#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date,<span class="at">format=</span><span class="st">&quot;%Y-%m-%d&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb94-9"><a href="tidyverse-22-reshaping-data.html#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">max</span>(date))</span></code></pre></div>
<p>Test your knowledge! Use functions we learned in the last section to answer these questions:</p>
<ol style="list-style-type: decimal">
<li>What is the last date for recorded cases? Is it the same for all states/counties?</li>
<li>Are all of the states listed in <code>favorite_states</code> in the dataset?</li>
<li>How many counties are there for each of the states?</li>
</ol>
<div id="example-datasets" class="section level4 hasAnchor" number="2.3.3.1">
<h4><span class="header-section-number">2.3.3.1</span> Example datasets<a href="tidyverse-22-reshaping-data.html#example-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Use the following three datasets to complete the coding exercises</strong> in <a href="https://github.com/darachm/dll-r/blob/main/worksheets/dll-r_Day4_Lab.Rmd">today’s worksheet</a>.
The datasets are based on the New York Times Data, which is loaded above.</p>
<p><strong>Example Dataset #1:<code>df_1</code></strong>
Three columns: county, cases, deaths</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="tidyverse-22-reshaping-data.html#cb95-1" aria-hidden="true" tabindex="-1"></a>df_1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="tidyverse-22-reshaping-data.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;metric&quot;</span>, <span class="at">value =</span> <span class="st">&quot;count&quot;</span>, <span class="fu">c</span>(cases, deaths)) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="tidyverse-22-reshaping-data.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(state,county)</span>
<span id="cb95-4"><a href="tidyverse-22-reshaping-data.html#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="tidyverse-22-reshaping-data.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_1)</span></code></pre></div>
<pre><code>##         date  county      state fips metric  count
## 1 2022-05-13 Alameda California 6001  cases 284054
## 2 2022-05-13 Alameda California 6001 deaths   1868
## 3 2022-05-13  Alpine California 6003  cases    126
## 4 2022-05-13  Alpine California 6003 deaths      0
## 5 2022-05-13  Amador California 6005  cases   9242
## 6 2022-05-13  Amador California 6005 deaths     86</code></pre>
<p><strong>Example Dataset #2:<code>df_2</code></strong>
Five columns: date, fips, metric corresponding to count, count, location (county, state)</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="tidyverse-22-reshaping-data.html#cb97-1" aria-hidden="true" tabindex="-1"></a>df_2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="tidyverse-22-reshaping-data.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;metric&quot;</span>, </span>
<span id="cb97-3"><a href="tidyverse-22-reshaping-data.html#cb97-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">value =</span> <span class="st">&quot;count&quot;</span>, </span>
<span id="cb97-4"><a href="tidyverse-22-reshaping-data.html#cb97-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(cases, deaths)) <span class="sc">%&gt;%</span></span>
<span id="cb97-5"><a href="tidyverse-22-reshaping-data.html#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county_state_fips =</span> <span class="fu">paste0</span>(county,<span class="st">&quot;,&quot;</span>, state, <span class="st">&quot;,&quot;</span>, fips)) <span class="sc">%&gt;%</span></span>
<span id="cb97-6"><a href="tidyverse-22-reshaping-data.html#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>county,<span class="sc">-</span>state)</span>
<span id="cb97-7"><a href="tidyverse-22-reshaping-data.html#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="tidyverse-22-reshaping-data.html#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_2)</span></code></pre></div>
<pre><code>##         date fips metric  count         county_state_fips
## 1 2022-05-13 6001  cases 284054   Alameda,California,6001
## 2 2022-05-13 6003  cases    126    Alpine,California,6003
## 3 2022-05-13 6005  cases   9242    Amador,California,6005
## 4 2022-05-13 6007  cases  40181     Butte,California,6007
## 5 2022-05-13 6009  cases   7754 Calaveras,California,6009
## 6 2022-05-13 6011  cases   4549    Colusa,California,6011</code></pre>
<p><strong>Example Dataset #3:<code>df_3</code></strong>
A column with the county name, followed by columns for each state with the number of cases for that state/county pair.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="tidyverse-22-reshaping-data.html#cb99-1" aria-hidden="true" tabindex="-1"></a>df_3 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="tidyverse-22-reshaping-data.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county,state,cases) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="tidyverse-22-reshaping-data.html#cb99-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">spread</span>(<span class="at">key =</span> <span class="st">&quot;state&quot;</span>, <span class="at">value =</span> <span class="st">&quot;cases&quot;</span>)</span>
<span id="cb99-4"><a href="tidyverse-22-reshaping-data.html#cb99-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-5"><a href="tidyverse-22-reshaping-data.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_3)</span></code></pre></div>
<pre><code>##      county California Florida Illinois Nebraska Washington
## 1     Adams         NA      NA    22525     6541       4926
## 2   Alachua         NA   69008       NA       NA         NA
## 3   Alameda     284054      NA       NA       NA         NA
## 4 Alexander         NA      NA     1288       NA         NA
## 5    Alpine        126      NA       NA       NA         NA
## 6    Amador       9242      NA       NA       NA         NA</code></pre>
<p><strong>Use these three datasets to complete the coding exercises</strong> in <a href="https://github.com/darachm/dll-r/blob/main/worksheets/dll-r_Day4_Lab.Rmd">today’s worksheet</a></p>

</div>
</div>
</div>
<p style="margin-top:10em;text-align:center;font-size:small;">
    <a href="https://github.com/darachm/dll-r/blob/main/LICENSE.md">
        Licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0
    </a>
</p>
<p style="text-align:center;font-size:small;">
    <a href="https://github.com/rstudio/bookdown" target="blank">
        Website typeset with bookdown
    </a>
</p>

<script> 
// This is to look through, everything that's a floating lone double dash,
// delete it. This is left over for stuff that's trying to be pauses for
// the slides
var listz = document.getElementsByTagName("p");
for (var i=0; i < listz.length; i++) { 
    if (listz[i].innerText === "–") { listz[i].innerText = "" } 
} 
</script>
            </section>

          </div>
        </div>
      </div>
<a href="tidyverse-12-functions-pipes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="making-plots-with-ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/darachm/dll-r/edit/main/430-tidyverse-part2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DLL 2021 R syllabus site.html"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"highlight": "zenburn"
});
});
</script>

</body>

</html>
