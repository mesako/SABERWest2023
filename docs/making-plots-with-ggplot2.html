<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Making plots with ggplot2 | DLL 2021, R section</title>
  <meta name="description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Making plots with ggplot2 | DLL 2021, R section" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="github-repo" content="darachm/dll-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Making plots with ggplot2 | DLL 2021, R section" />
  
  <meta name="twitter:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  

<meta name="author" content="mesako" />
<meta name="author" content="Margaret" />
<meta name="author" content="Samson" />
<meta name="author" content="Zac" />
<meta name="author" content="darachm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tidyverse-22-reshaping-data.html"/>
<link rel="next" href="making-scientific-figures.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DLL 2021 R workshops</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workshop Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="workshop-goals.html"><a href="workshop-goals.html"><i class="fa fa-check"></i><b>1.1</b> Workshop goals</a></li>
<li class="chapter" data-level="1.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html"><i class="fa fa-check"></i><b>1.2</b> Structure and resources</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="structure-and-resources.html"><a href="structure-and-resources.html#workshop-schedule"><i class="fa fa-check"></i><b>1.2.1</b> Workshop schedule</a></li>
<li class="chapter" data-level="1.2.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html#asynchronous-sessions"><i class="fa fa-check"></i><b>1.2.2</b> Asynchronous sessions</a></li>
<li class="chapter" data-level="1.2.3" data-path="structure-and-resources.html"><a href="structure-and-resources.html#synchronous-sessions"><i class="fa fa-check"></i><b>1.2.3</b> Synchronous sessions</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="workshop-expectations.html"><a href="workshop-expectations.html"><i class="fa fa-check"></i><b>1.3</b> Workshop expectations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-4---tidyverse-and-visualizations.html"><a href="day-4---tidyverse-and-visualizations.html"><i class="fa fa-check"></i><b>2</b> Day 4 - tidyverse and visualizations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html"><i class="fa fa-check"></i><b>2.1</b> Reading and processing data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html#loading-a-file-into-r"><i class="fa fa-check"></i><b>2.1.1</b> Loading a file into R</a></li>
<li class="chapter" data-level="2.1.2" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html#handling-issues-in-data"><i class="fa fa-check"></i><b>2.1.2</b> Handling issues in data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html"><i class="fa fa-check"></i><b>2.2</b> Tidyverse 1/2: functions &amp; pipes</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>2.2.1</b> Welcome to the tidyverse!</a></li>
<li class="chapter" data-level="2.2.2" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#load-tidyverse"><i class="fa fa-check"></i><b>2.2.2</b> Load tidyverse</a></li>
<li class="chapter" data-level="2.2.3" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#how-to-pipe"><i class="fa fa-check"></i><b>2.2.3</b> How to pipe %&gt;%</a></li>
<li class="chapter" data-level="2.2.4" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#essential-tidyverse-functions"><i class="fa fa-check"></i><b>2.2.4</b> Essential tidyverse functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html"><i class="fa fa-check"></i><b>2.3</b> Tidyverse 2/2: reshaping data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#why-tidy-data"><i class="fa fa-check"></i><b>2.3.1</b> Why tidy data</a></li>
<li class="chapter" data-level="2.3.2" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#how-to-tidy-data"><i class="fa fa-check"></i><b>2.3.2</b> How to tidy data</a></li>
<li class="chapter" data-level="2.3.3" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#data-exploration-with-tidyverse"><i class="fa fa-check"></i><b>2.3.3</b> Data exploration with tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>2.4</b> Making plots with ggplot2</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#getting-started-with-a-ggplot"><i class="fa fa-check"></i><b>2.4.1</b> Getting started with a ggplot</a></li>
<li class="chapter" data-level="2.4.2" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#changing-plot-aesthetics"><i class="fa fa-check"></i><b>2.4.2</b> Changing plot aesthetics</a></li>
<li class="chapter" data-level="2.4.3" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#exploring-simple-plots"><i class="fa fa-check"></i><b>2.4.3</b> Exploring simple plots</a></li>
<li class="chapter" data-level="2.4.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#visualizing-between-groups"><i class="fa fa-check"></i><b>2.4.4</b> Visualizing between groups</a></li>
<li class="chapter" data-level="2.4.5" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#generating-heatmaps-optional"><i class="fa fa-check"></i><b>2.4.5</b> Generating heatmaps (OPTIONAL)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html"><i class="fa fa-check"></i><b>2.5</b> Making scientific figures</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#plotting-error-bars"><i class="fa fa-check"></i><b>2.5.1</b> Plotting error bars</a></li>
<li class="chapter" data-level="2.5.2" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#showing-trends-in-data"><i class="fa fa-check"></i><b>2.5.2</b> Showing trends in data</a></li>
<li class="chapter" data-level="2.5.3" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#saving-figures-locally"><i class="fa fa-check"></i><b>2.5.3</b> Saving figures locally</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html"><i class="fa fa-check"></i><b>2.6</b> Applying basic stats</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#describing-quantitative-variables"><i class="fa fa-check"></i><b>2.6.1</b> Describing quantitative variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#finding-differences-in-data"><i class="fa fa-check"></i><b>2.6.2</b> Finding differences in data</a></li>
<li class="chapter" data-level="2.6.3" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#identifying-correlations"><i class="fa fa-check"></i><b>2.6.3</b> Identifying correlations</a></li>
<li class="chapter" data-level="2.6.4" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#producing-linear-models"><i class="fa fa-check"></i><b>2.6.4</b> Producing linear models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>3</b> Appendix</a>
<ul>
<li class="chapter" data-level="3.1" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html"><i class="fa fa-check"></i><b>3.1</b> Some links and some extras</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html#ideas-for-figures"><i class="fa fa-check"></i><b>3.1.1</b> Ideas for figures</a></li>
<li class="chapter" data-level="3.1.2" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html#more-links"><i class="fa fa-check"></i><b>3.1.2</b> More links</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DLL 2021, R section</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="making-plots-with-ggplot2" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Making plots with ggplot2<a href="making-plots-with-ggplot2.html#making-plots-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will primarily be working in ggplot2 as it has the greatest degree of customization for visualization and offers many additional features over the basic plotting in R.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="making-plots-with-ggplot2.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb101-2"><a href="making-plots-with-ggplot2.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div id="getting-started-with-a-ggplot" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Getting started with a ggplot<a href="making-plots-with-ggplot2.html#getting-started-with-a-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Most ggplot calls to create a figure take the following form (you can read more using <code>help(ggplot)</code>):</p>
<p><code>ggplot(data = &lt;DATA&gt;, mapping = aes(&lt;MAPPINGS&gt;)) + &lt;GEOM_FUNCTION&gt;()</code></p>
<p>We will practice using our mammalian sleep dataset. You can look up more info about this dataset using the <code>help</code> function and the dataset name, <code>msleep</code>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="making-plots-with-ggplot2.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(msleep)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 11
##   name    genus vore  order conservation sleep_total sleep_rem sleep_cycle awake
##   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
## 1 Cheetah Acin… carni Carn… lc                  12.1      NA        NA      11.9
## 2 Owl mo… Aotus omni  Prim… &lt;NA&gt;                17         1.8      NA       7  
## 3 Mounta… Aplo… herbi Rode… nt                  14.4       2.4      NA       9.6
## 4 Greate… Blar… omni  Sori… lc                  14.9       2.3       0.133   9.1
## 5 Cow     Bos   herbi Arti… domesticated         4         0.7       0.667  20  
## 6 Three-… Brad… herbi Pilo… &lt;NA&gt;                14.4       2.2       0.767   9.6
## # … with 2 more variables: brainwt &lt;dbl&gt;, bodywt &lt;dbl&gt;</code></pre>
<p>You will first use the <code>ggplot()</code> function and bind the plot to a specific data frame using the data argument.</p>
<p><code>ggplot(data = msleep)</code></p>
<p>You will next need to define a mapping (using the aesthetic or <code>aes</code> function), by selecting the variables to be plotted and specifying how to present them in the graph, e.g. as x/y positions or characteristics such as size, shape, color, etc.</p>
<p><code>ggplot(data = msleep, aes(x = brainwt, y = sleep_rem))</code></p>
<p>You can then add “geoms” or graphical representations of the data in the plot (points, lines, bars). <code>ggplot2</code> offers many different geoms including:</p>
<ul>
<li><code>geom_point()</code> for scatter plots, dot plots, etc.</li>
<li><code>geom_boxplot()</code> for, well, boxplots!</li>
<li><code>geom_line()</code> for trend lines, time series, etc.</li>
</ul>
<p>To add a geom to the plot use the <code>+</code> operator. To plot using two continuous variables, we will use <code>geom_point()</code> first. To save your work-in-progress, you can assign the plot to a variable.</p>
<p>First we establish our coordinate system.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="making-plots-with-ggplot2.html#cb104-1" aria-hidden="true" tabindex="-1"></a>my.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> msleep, <span class="fu">aes</span>(<span class="at">x =</span> brainwt, <span class="at">y =</span> sleep_rem))</span></code></pre></div>
<p>We can now draw the plot as a scatterplot with points to represent each mammal’s measurements from the <code>msleep</code> dataset (worksheet task 3.4.1A).</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="making-plots-with-ggplot2.html#cb105-1" aria-hidden="true" tabindex="-1"></a>my.plot <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot4-1.png" width="672" /></p>
<p>You might notice that all of the points are squished against the y-axis since many of the mammals in this dataset have low brain weights.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="making-plots-with-ggplot2.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(msleep<span class="sc">$</span>brainwt)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
## 0.00014 0.00290 0.01240 0.28158 0.12550 5.71200      27</code></pre>
<p>As you can see with the <code>summary</code> function, the minimum and median values are very low, but there are a few mammals with high <code>brainwt</code> as you can see by the much larger maximum value in this vector.</p>
<p>To make more useful plots, we can transform this value using log-scaling. While we will have to note that the new values do not exactly match the real-world measurements anymore, patterns we see (i.e. something that correlates with higher brain weights) will still hold true.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="making-plots-with-ggplot2.html#cb109-1" aria-hidden="true" tabindex="-1"></a>msleep2 <span class="ot">&lt;-</span> msleep <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">brainwt_log =</span> <span class="fu">log</span>(brainwt))</span>
<span id="cb109-2"><a href="making-plots-with-ggplot2.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep2, <span class="fu">aes</span>(<span class="at">x =</span> brainwt_log, <span class="at">y =</span> sleep_rem)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot6-1.png" width="672" /></p>
<p>Here we use the <code>mutate</code> function to make a new variable called <code>brainwt_log</code> in our dataset (technically a new dataset copy that we have saved as <code>msleep2</code>). Plotting this variable as our x variable (i.e. independent variable), makes it easier to look for patterns (worksheet tasks 3.4.1B and 3.4.1C).</p>
<hr />
</div>
<div id="changing-plot-aesthetics" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Changing plot aesthetics<a href="making-plots-with-ggplot2.html#changing-plot-aesthetics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can modify the appearance of the plot in two ways: either uniformly changing the appearance or having the appearance vary depending on information present in our data.</p>
<p>Let’s explore how to modify our plots uniformly. We can change aspects of the points we plot such as transparency (“alpha”) and color by supplying them as arguments in the <code>geom_point</code> function.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="making-plots-with-ggplot2.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> msleep2, <span class="fu">aes</span>(<span class="at">x =</span> brainwt_log, <span class="at">y =</span> sleep_rem)) <span class="sc">+</span></span>
<span id="cb111-2"><a href="making-plots-with-ggplot2.html#cb111-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot7-1.png" width="672" /></p>
<p>Here we have made the plots semi-transparent and colored blue. You can try varying these values (e.g. change blue to a different color). You can also supply other arguments such as <code>shape</code> to use something other than a dot (worksheet task 3.4.2A).</p>
<p>However, it is also possible to scale the color of the points by some variable present in the data. This approach means we can create a scatterplot that conveys more than just two variables’ worth of information (x-axis and y-axis) by having the color reflect a third variable.</p>
<p>To do this, we specify the <code>color</code> inside the aesthetic mapping <code>aes</code> within the initial <code>ggplot</code> function. Same as how we told R to use a specific column by name for <code>x</code> or <code>y</code> coordinates, we specify which column to use for <code>color</code> (worksheet task 3.4.2B).</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="making-plots-with-ggplot2.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep2, <span class="fu">aes</span>(<span class="at">x =</span> brainwt_log, <span class="at">y =</span> sleep_rem, <span class="at">color =</span> vore)) <span class="sc">+</span> </span>
<span id="cb113-2"><a href="making-plots-with-ggplot2.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot8-1.png" width="672" /></p>
<p>This plot conveys not only the relationship between <code>brainwt_log</code> and <code>sleep_rem</code>, but each plot representing a different mammal now conveys what the feeding behavior of that mammal is.</p>
<p>When generating visualizations, it is important to annotate the figure with meaningful labels on the axes to make them accessible for the viewer. For that, we can use the <code>labs</code> function (worksheet task 3.4.2C).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="making-plots-with-ggplot2.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep2, <span class="fu">aes</span>(<span class="at">x =</span> brainwt_log, <span class="at">y =</span> sleep_rem, <span class="at">color =</span> vore)) <span class="sc">+</span> </span>
<span id="cb115-2"><a href="making-plots-with-ggplot2.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb115-3"><a href="making-plots-with-ggplot2.html#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Brain Weight (log)&quot;</span>, </span>
<span id="cb115-4"><a href="making-plots-with-ggplot2.html#cb115-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Duration of REM Sleep&quot;</span>,</span>
<span id="cb115-5"><a href="making-plots-with-ggplot2.html#cb115-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Feeding Behavior&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot9-1.png" width="672" /></p>
<hr />
</div>
<div id="exploring-simple-plots" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Exploring simple plots<a href="making-plots-with-ggplot2.html#exploring-simple-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s consider how we make other plots besides a scatterplot.</p>
<p>Scatterplots are a great way to look at two quantitative (numerical) values at the same time to observe patterns (i.e. correlations) between the variables or to identify interesting outliers.</p>
<p>However, other plots may be more useful to look at differing numbers of variables (i.e. one quantitative variable) or different types of variables (i.e. qualitative or categorical data). Here, we discuss two types of single variable plots that look at either a quantitative variable (histogram) or a categorical variable (barplot).</p>
<p>We can create histograms in ggplot2 that are more aesthetically pleasing than the default <code>hist</code> function. This shows the distribution of one quantitative variable (worksheet tasks 3.4.3A and 3.4.3B).</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="making-plots-with-ggplot2.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep, <span class="fu">aes</span>(<span class="at">x =</span> sleep_total)) <span class="sc">+</span></span>
<span id="cb117-2"><a href="making-plots-with-ggplot2.html#cb117-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot10-1.png" width="672" /></p>
<p>We can look at how many individuals in the dataset fall into each category, such as how many mammals have each kind of feeding behavior (worksheet task 3.4.3C).</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="making-plots-with-ggplot2.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> msleep, <span class="fu">aes</span>(<span class="at">x =</span> vore)) <span class="sc">+</span> </span>
<span id="cb118-2"><a href="making-plots-with-ggplot2.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot11-1.png" width="672" /></p>
<p>As you can see where we map the aesthetic, we only tell the <code>ggplot</code> function to refer to a single column in our dataset for our x-axis.</p>
<hr />
</div>
<div id="visualizing-between-groups" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Visualizing between groups<a href="making-plots-with-ggplot2.html#visualizing-between-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s return to <code>iris</code> dataset to explore how we can visualize differences between groups/categories. These groups are often represented in our data as a factor.</p>
<p>We can look at how the distributions of <code>Sepal.Length</code> differ depending on which species each iris belongs to. One plot that can do this easily is the <code>geom_boxplot</code> function (worksheet task 3.4.4A).</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="making-plots-with-ggplot2.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Length)) <span class="sc">+</span> </span>
<span id="cb119-2"><a href="making-plots-with-ggplot2.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot12-1.png" width="672" /></p>
<p>By adding a different parameter to <code>fill</code> in the <code>aes</code> we define throgh the <code>ggplot</code> function, we can separate out histograms according to different groupings. Here, we use <code>Species</code> to determine the color of the fill.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="making-plots-with-ggplot2.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb120-2"><a href="making-plots-with-ggplot2.html#cb120-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot13-1.png" width="672" /></p>
<p>While we can sort of see the trends on this plot, it may be helpful to separate out each histogram for each individual species. There is an easy way to do this in <code>ggplot2</code> using facetting or the <code>facet_wrap</code> function. This function splits the figure into separate panel where the data has been filtered by the category (i.e. <code>Species</code>) (worksheet task 3.4.4B).</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="making-plots-with-ggplot2.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb121-2"><a href="making-plots-with-ggplot2.html#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb121-3"><a href="making-plots-with-ggplot2.html#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Species)</span></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot14-1.png" width="672" /></p>
<p>This matches what we already saw in the boxplot, showing that there are different sepal lengths depending on which iris species we look at. We will explore in the next section how we know if these differences are significant.</p>
<hr />
</div>
<div id="generating-heatmaps-optional" class="section level3 hasAnchor" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Generating heatmaps (OPTIONAL)<a href="making-plots-with-ggplot2.html#generating-heatmaps-optional" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you are already familiar with ggplot2 or progress quickly through that material, you may consider reading this subsection. Otherwise, feel free to skip ahead!</p>
<p>Heatmaps are a useful way to show the values of multiple samples across many measurements. You can visualize a heatmap by thinking of your dataframe, this tabular data, if it had each cell colorcoded based on how high or low the value is.</p>
<p>The base R <code>heatmap</code> function meets many needs while the ggplot2 equivalent (<code>geom_tile</code>) can be confusing so we will recommend that you not use ggplot2 for heatmaps.</p>
<p>Let’s go back to <code>msleep</code> dataset to visualize trends between the different measurements taken on each mammal. We will first create a simplified dataset from <code>msleep</code> where we take the log value of both <code>brainwt</code> and <code>bodywt</code> (worksheet task 3.4.5A).</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="making-plots-with-ggplot2.html#cb122-1" aria-hidden="true" tabindex="-1"></a>temp.data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">log</span>(msleep<span class="sc">$</span>brainwt), <span class="fu">log</span>(msleep<span class="sc">$</span>bodywt))</span>
<span id="cb122-2"><a href="making-plots-with-ggplot2.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(temp.data)</span></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,]         NA  3.9120230
## [2,] -4.1669153 -0.7339692
## [3,]         NA  0.3001046
## [4,] -8.1456296 -3.9633163
## [5,] -0.8603831  6.3969297
## [6,]         NA  1.3480731</code></pre>
<p>Next, we feed these numeric values into the <code>heatmap</code> function along with some arguments that specify settings for displaying the figure. We use <code>labCol</code> to specify how to label these columns and <code>cexCol</code> to control the text size of these labels. We set <code>labRow</code> to be the names of each species from the msleep dataset (worksheet task 3.4.5B).</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="making-plots-with-ggplot2.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(temp.data, <span class="at">labRow =</span> msleep<span class="sc">$</span>name, <span class="at">labCol =</span> <span class="fu">c</span>(<span class="st">&quot;brainwt&quot;</span>, <span class="st">&quot;bodywt&quot;</span>), <span class="at">cexCol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot16-1.png" width="672" /></p>
<p>This first heatmap will look strange because it colors each box by its magnitude, but body weight of a mammal is always greater than its brain weight. We want to scale within each column so that the depth of the color reflects whether the mammal has a high brain weight or high body weight <strong>relative to the other mammals</strong> (worksheet task 3.4.5C).</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="making-plots-with-ggplot2.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(temp.data, <span class="at">scale =</span> <span class="st">&quot;col&quot;</span>, <span class="at">labRow =</span> msleep<span class="sc">$</span>name, <span class="at">labCol =</span> <span class="fu">c</span>(<span class="st">&quot;brainwt&quot;</span>, <span class="st">&quot;bodywt&quot;</span>), <span class="at">cexCol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot17-1.png" width="672" /></p>
<p>Using the <code>scale</code> argument which we set to <code>"col"</code>, now the color of the columns is more meaningful. For example, it makes sense that the measurements taken on an Asian elephant are much higher than those from a mole rat, so the color of those cells is deeper.</p>
<p>Let’s add some more data to our heatmap visualization (worksheet task 3.4.5D and 3.4.5E).</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="making-plots-with-ggplot2.html#cb126-1" aria-hidden="true" tabindex="-1"></a>temp.data2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(temp.data, msleep<span class="sc">$</span>sleep_total, msleep<span class="sc">$</span>sleep_rem)</span>
<span id="cb126-2"><a href="making-plots-with-ggplot2.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(temp.data2, <span class="at">scale =</span> <span class="st">&quot;col&quot;</span>, <span class="at">labRow =</span> msleep<span class="sc">$</span>name,</span>
<span id="cb126-3"><a href="making-plots-with-ggplot2.html#cb126-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">labCol =</span> <span class="fu">c</span>(<span class="st">&quot;brainwt&quot;</span>, <span class="st">&quot;bodywt&quot;</span>, <span class="st">&quot;total_sleep&quot;</span>, <span class="st">&quot;rem_sleep&quot;</span>), <span class="at">cexCol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/ggplot18-1.png" width="672" /></p>
<p>You may have noticed the weird diagrams along the top and left hand side of this heatmap. These strange line diagrams are trees that show how our samples cluster together. Mammals that have similar patterns of values across these four measurements are placed near each other in the diagram.</p>

</div>
</div>
<p style="margin-top:10em;text-align:center;font-size:small;">
    <a href="https://github.com/darachm/dll-r/blob/main/LICENSE.md">
        Licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0
    </a>
</p>
<p style="text-align:center;font-size:small;">
    <a href="https://github.com/rstudio/bookdown" target="blank">
        Website typeset with bookdown
    </a>
</p>

<script> 
// This is to look through, everything that's a floating lone double dash,
// delete it. This is left over for stuff that's trying to be pauses for
// the slides
var listz = document.getElementsByTagName("p");
for (var i=0; i < listz.length; i++) { 
    if (listz[i].innerText === "–") { listz[i].innerText = "" } 
} 
</script>
            </section>

          </div>
        </div>
      </div>
<a href="tidyverse-22-reshaping-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="making-scientific-figures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/darachm/dll-r/edit/main/440-intro-to-ggplot2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DLL 2021 R syllabus site.html"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"highlight": "zenburn"
});
});
</script>

</body>

</html>
