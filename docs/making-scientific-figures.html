<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.5 Making scientific figures | DLL 2021, R section</title>
  <meta name="description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2.5 Making scientific figures | DLL 2021, R section" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="github-repo" content="darachm/dll-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.5 Making scientific figures | DLL 2021, R section" />
  
  <meta name="twitter:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  

<meta name="author" content="mesako" />
<meta name="author" content="Margaret" />
<meta name="author" content="Samson" />
<meta name="author" content="Zac" />
<meta name="author" content="darachm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="making-plots-with-ggplot2.html"/>
<link rel="next" href="applying-basic-stats.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DLL 2021 R workshops</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workshop Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="workshop-goals.html"><a href="workshop-goals.html"><i class="fa fa-check"></i><b>1.1</b> Workshop goals</a></li>
<li class="chapter" data-level="1.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html"><i class="fa fa-check"></i><b>1.2</b> Structure and resources</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="structure-and-resources.html"><a href="structure-and-resources.html#workshop-schedule"><i class="fa fa-check"></i><b>1.2.1</b> Workshop schedule</a></li>
<li class="chapter" data-level="1.2.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html#asynchronous-sessions"><i class="fa fa-check"></i><b>1.2.2</b> Asynchronous sessions</a></li>
<li class="chapter" data-level="1.2.3" data-path="structure-and-resources.html"><a href="structure-and-resources.html#synchronous-sessions"><i class="fa fa-check"></i><b>1.2.3</b> Synchronous sessions</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="workshop-expectations.html"><a href="workshop-expectations.html"><i class="fa fa-check"></i><b>1.3</b> Workshop expectations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-4---tidyverse-and-visualizations.html"><a href="day-4---tidyverse-and-visualizations.html"><i class="fa fa-check"></i><b>2</b> Day 4 - tidyverse and visualizations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html"><i class="fa fa-check"></i><b>2.1</b> Reading and processing data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html#loading-a-file-into-r"><i class="fa fa-check"></i><b>2.1.1</b> Loading a file into R</a></li>
<li class="chapter" data-level="2.1.2" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html#handling-issues-in-data"><i class="fa fa-check"></i><b>2.1.2</b> Handling issues in data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html"><i class="fa fa-check"></i><b>2.2</b> Tidyverse 1/2: functions &amp; pipes</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>2.2.1</b> Welcome to the tidyverse!</a></li>
<li class="chapter" data-level="2.2.2" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#load-tidyverse"><i class="fa fa-check"></i><b>2.2.2</b> Load tidyverse</a></li>
<li class="chapter" data-level="2.2.3" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#how-to-pipe"><i class="fa fa-check"></i><b>2.2.3</b> How to pipe %&gt;%</a></li>
<li class="chapter" data-level="2.2.4" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#essential-tidyverse-functions"><i class="fa fa-check"></i><b>2.2.4</b> Essential tidyverse functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html"><i class="fa fa-check"></i><b>2.3</b> Tidyverse 2/2: reshaping data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#why-tidy-data"><i class="fa fa-check"></i><b>2.3.1</b> Why tidy data</a></li>
<li class="chapter" data-level="2.3.2" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#how-to-tidy-data"><i class="fa fa-check"></i><b>2.3.2</b> How to tidy data</a></li>
<li class="chapter" data-level="2.3.3" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#data-exploration-with-tidyverse"><i class="fa fa-check"></i><b>2.3.3</b> Data exploration with tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>2.4</b> Making plots with ggplot2</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#getting-started-with-a-ggplot"><i class="fa fa-check"></i><b>2.4.1</b> Getting started with a ggplot</a></li>
<li class="chapter" data-level="2.4.2" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#changing-plot-aesthetics"><i class="fa fa-check"></i><b>2.4.2</b> Changing plot aesthetics</a></li>
<li class="chapter" data-level="2.4.3" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#exploring-simple-plots"><i class="fa fa-check"></i><b>2.4.3</b> Exploring simple plots</a></li>
<li class="chapter" data-level="2.4.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#visualizing-between-groups"><i class="fa fa-check"></i><b>2.4.4</b> Visualizing between groups</a></li>
<li class="chapter" data-level="2.4.5" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#generating-heatmaps-optional"><i class="fa fa-check"></i><b>2.4.5</b> Generating heatmaps (OPTIONAL)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html"><i class="fa fa-check"></i><b>2.5</b> Making scientific figures</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#plotting-error-bars"><i class="fa fa-check"></i><b>2.5.1</b> Plotting error bars</a></li>
<li class="chapter" data-level="2.5.2" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#showing-trends-in-data"><i class="fa fa-check"></i><b>2.5.2</b> Showing trends in data</a></li>
<li class="chapter" data-level="2.5.3" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#saving-figures-locally"><i class="fa fa-check"></i><b>2.5.3</b> Saving figures locally</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html"><i class="fa fa-check"></i><b>2.6</b> Applying basic stats</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#describing-quantitative-variables"><i class="fa fa-check"></i><b>2.6.1</b> Describing quantitative variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#finding-differences-in-data"><i class="fa fa-check"></i><b>2.6.2</b> Finding differences in data</a></li>
<li class="chapter" data-level="2.6.3" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#identifying-correlations"><i class="fa fa-check"></i><b>2.6.3</b> Identifying correlations</a></li>
<li class="chapter" data-level="2.6.4" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#producing-linear-models"><i class="fa fa-check"></i><b>2.6.4</b> Producing linear models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>3</b> Appendix</a>
<ul>
<li class="chapter" data-level="3.1" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html"><i class="fa fa-check"></i><b>3.1</b> Some links and some extras</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html#ideas-for-figures"><i class="fa fa-check"></i><b>3.1.1</b> Ideas for figures</a></li>
<li class="chapter" data-level="3.1.2" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html#more-links"><i class="fa fa-check"></i><b>3.1.2</b> More links</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DLL 2021, R section</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="making-scientific-figures" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Making scientific figures<a href="making-scientific-figures.html#making-scientific-figures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Making plots can be a great way to develop an intuition for your dataset, though to derive and communicate scientific insights, we need to have an idea of the uncertainty in our interpretations.</p>
<p>Uncertainty describes ideas such as: are the values between two groups different enough, that it is unlikely that the differences are due to chance? Is the correlation between these variables strong enough that one can predict the other, with some level of confidence? <strong>How statistically significant are the patterns we see?</strong></p>
<div id="plotting-error-bars" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Plotting error bars<a href="making-scientific-figures.html#plotting-error-bars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we compare measurements taken from two samples (i.e. two groups), we might want to see if the two groups have very different values for that specific measurement. If we have multiple observations within each group, we can take a summary statistic such as the mean or median and plot those against each other.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="making-scientific-figures.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep2, <span class="fu">aes</span>(<span class="at">x =</span> vore, <span class="at">y =</span> awake)) <span class="sc">+</span> </span>
<span id="cb127-2"><a href="making-scientific-figures.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<p><img src="450-scientific-figures_files/figure-html/scifig2-1.png" width="672" /></p>
<p>For example, here we have asked our <code>geom_bar</code> function to plot a summary, specifically the mean of each group, instead of plotting <code>identity</code> which usually means the value as is. Looking at this figure, we can’t guess if the groups are significantly different without an idea of the uncertainty in our measurements through something like error bars.</p>
<p>Here is the convention for plotting error bars in ggplot2, as you can see it is just another kind of geom that we can add to our plot:</p>
<p><code>ggplot(data = &lt;SUMMARY DATA&gt;, mapping = aes(&lt;SUMMARY MAPPINGS&gt;) + geom_bar(stat = "identity") + geom_errorbar(aes(&lt;ERROR MAPPINGS&gt;))</code></p>
<p>This method is straightforward, but you need to have pre-calculated the summary statistic for each group and the amount of error (i.e. standard error) from your data. That “aggregated” dataframe becomes the data that you provide to ggplot, instead of the original dataset (worksheet task 3.5.1A).</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="making-scientific-figures.html#cb128-1" aria-hidden="true" tabindex="-1"></a>feeding.data <span class="ot">&lt;-</span> msleep2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(vore) <span class="sc">%&gt;%</span> </span>
<span id="cb128-2"><a href="making-scientific-figures.html#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">mean_se</span>(awake))</span>
<span id="cb128-3"><a href="making-scientific-figures.html#cb128-3" aria-hidden="true" tabindex="-1"></a>feeding.data</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   vore        y  ymin  ymax
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 carni   13.6  12.6   14.7
## 2 herbi   14.5  13.6   15.4
## 3 insecti  9.06  6.41  11.7
## 4 omni    13.1  12.4   13.7
## 5 &lt;NA&gt;    13.8  12.7   14.9</code></pre>
<p>What does <code>mean_se</code> do? We can check.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="making-scientific-figures.html#cb130-1" aria-hidden="true" tabindex="-1"></a>?mean_se</span></code></pre></div>
<p>This function returns three values, <code>y</code>, <code>ymin</code>, and <code>ymax</code> which correspond to the mean, the mean minus one standard error, and the mean plus one standard error. The mean value will be the height of each bar on the barplot, while <code>ymin</code> corresponds to the bottom of the error bar and <code>ymax</code> to the top of the error bar.</p>
<p>Let’s first plot the height of the bars using this new <code>feeding.data</code> dataset and mapping <code>y</code> to our new <code>y</code> column generated from the <code>mean_se</code> function. Here we create the same plot as before from this aggregated dataset, just showing the mean value in each group (worksheet task 3.5.1B).</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="making-scientific-figures.html#cb131-1" aria-hidden="true" tabindex="-1"></a>my.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(feeding.data, <span class="fu">aes</span>(<span class="at">x =</span> vore, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb131-2"><a href="making-scientific-figures.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)</span>
<span id="cb131-3"><a href="making-scientific-figures.html#cb131-3" aria-hidden="true" tabindex="-1"></a>my.plot</span></code></pre></div>
<p><img src="450-scientific-figures_files/figure-html/scifig5-1.png" width="672" /></p>
<p>Now we add the error bars, mapping the <code>ymin</code> and <code>ymax</code> values to the arguments that happen to have the same name in the <code>geom_errorbar</code> function. We add in the <code>width</code> setting just for aesthetics (worksheet tasks 3.5.1C and 3.5.1D).</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="making-scientific-figures.html#cb132-1" aria-hidden="true" tabindex="-1"></a>my.plot <span class="ot">&lt;-</span> my.plot <span class="sc">+</span> <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax),</span>
<span id="cb132-2"><a href="making-scientific-figures.html#cb132-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">width =</span> <span class="fl">0.2</span>)</span>
<span id="cb132-3"><a href="making-scientific-figures.html#cb132-3" aria-hidden="true" tabindex="-1"></a>my.plot</span></code></pre></div>
<p><img src="450-scientific-figures_files/figure-html/scifig6-1.png" width="672" /></p>
<p>Now it is more clear that insectivores have significantly less time awake compared to other kinds of mammals.</p>
<hr />
</div>
<div id="showing-trends-in-data" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Showing trends in data<a href="making-scientific-figures.html#showing-trends-in-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lots of these different figures summarize or aggregate the data. We may want to display the data with the individual points, but still show the overall trend across the data. Some good plots that do this are <code>geom_density_2d</code> which provides a contour plot.</p>
<p>Let’s check out the trend in our <code>msleep</code> data between body weight and brain weight. We will create a new column where we take the log value of body weight, like we did with brain weight.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="making-scientific-figures.html#cb133-1" aria-hidden="true" tabindex="-1"></a>msleep3 <span class="ot">&lt;-</span> msleep2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">bodywt_log =</span> <span class="fu">log</span>(bodywt))</span>
<span id="cb133-2"><a href="making-scientific-figures.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> msleep3, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> brainwt_log, <span class="at">y =</span> bodywt_log)) <span class="sc">+</span></span>
<span id="cb133-3"><a href="making-scientific-figures.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_2d</span>() <span class="sc">+</span></span>
<span id="cb133-4"><a href="making-scientific-figures.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="450-scientific-figures_files/figure-html/scifig7-1.png" width="672" /></p>
<p>As you can see the density of points almost look like they fit a line. As brain weight increases then body weight increases, or vice versa. We can add a trendline to this plot with the <code>geom_smooth</code> function (worksheet tasks 3.5.2A and 3.5.2B).</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="making-scientific-figures.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep3, <span class="fu">aes</span>(<span class="at">x =</span> brainwt_log, <span class="at">y =</span> bodywt_log)) <span class="sc">+</span></span>
<span id="cb134-2"><a href="making-scientific-figures.html#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb134-3"><a href="making-scientific-figures.html#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="450-scientific-figures_files/figure-html/scifig8-1.png" width="672" /></p>
<p>We can also do this with trendlines that summarize only certain subsets of the data, such as those that belong to a specific category. We will flip back to our <code>iris</code> dataset to look at how sepal length compares to sepal width between different species of iris.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="making-scientific-figures.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span> </span>
<span id="cb136-2"><a href="making-scientific-figures.html#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb136-3"><a href="making-scientific-figures.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species)) </span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="450-scientific-figures_files/figure-html/scifig9-1.png" width="672" /></p>
<p>We create a seaprate trendline for each by specifiying the <code>aes</code> with color mapping to <code>Species</code> within the <code>geom_smooth</code> function.</p>
<p>The above plot may make it hard to see the data that is contributing to each trend line. Using <code>facet_wrap</code> again, we can split the figure into separate panel where the data has been filtered by the category (i.e. species) (worksheet task 3.5.2C).</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="making-scientific-figures.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb138-2"><a href="making-scientific-figures.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb138-3"><a href="making-scientific-figures.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb138-4"><a href="making-scientific-figures.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Species)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="450-scientific-figures_files/figure-html/scifig10-1.png" width="672" /></p>
<p>Now it is clear that there is a positive correlation (as one goes up, the other goes up) in each species of iris, but some species have a sharper upward trend than others.</p>
<hr />
</div>
<div id="saving-figures-locally" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Saving figures locally<a href="making-scientific-figures.html#saving-figures-locally" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As you produce analysis in your research, you may want to create high-quality images of your figures to then use in presentations or publications. There are two easy ways to save images as an individual file on your computer (worksheet tasks 3.5.3A and 3.5.3B),</p>
<p>The first method uses <code>ggsave</code> to save the most recent ggplot figure you generated (worksheet task 3.5.3C).</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="making-scientific-figures.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep2, <span class="fu">aes</span>(<span class="at">x =</span> brainwt_log, <span class="at">y =</span> sleep_rem)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb140-2"><a href="making-scientific-figures.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span>
<span id="cb140-3"><a href="making-scientific-figures.html#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;plot.png&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>This function will save the figure just produced by this code wherever your directory is currently. You can check your current directory with <code>getwd()</code> and change with <code>setwd(&lt;FOLDER NAME&gt;)</code>. You can also provide a precise file path in the new file name.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="making-scientific-figures.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;~/Downloads/plot.png&quot;</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>Here is an alternative method for saving your figures:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="making-scientific-figures.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;plot.pdf&quot;</span>) <span class="co"># creates the file</span></span>
<span id="cb142-2"><a href="making-scientific-figures.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co"># png() also works if you want a different file format</span></span>
<span id="cb142-3"><a href="making-scientific-figures.html#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep2, <span class="fu">aes</span>(<span class="at">x =</span> brainwt_log, <span class="at">y =</span> sleep_rem)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb142-4"><a href="making-scientific-figures.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span>
<span id="cb142-5"><a href="making-scientific-figures.html#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() <span class="co"># finishes editing the file</span></span></code></pre></div>
<p>Any changes to the figure that are contained between the initial creation of the figure (i.e. the <code>pdf</code> command) and the <code>dev.off</code> command will be included in the final saved image (worksheet task 3.5.3D). However, the figure is being printed directly to the file it is writing and won’t appear elsewhere (worksheet task 3.5.3E).</p>

</div>
</div>
<p style="margin-top:10em;text-align:center;font-size:small;">
    <a href="https://github.com/darachm/dll-r/blob/main/LICENSE.md">
        Licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0
    </a>
</p>
<p style="text-align:center;font-size:small;">
    <a href="https://github.com/rstudio/bookdown" target="blank">
        Website typeset with bookdown
    </a>
</p>

<script> 
// This is to look through, everything that's a floating lone double dash,
// delete it. This is left over for stuff that's trying to be pauses for
// the slides
var listz = document.getElementsByTagName("p");
for (var i=0; i < listz.length; i++) { 
    if (listz[i].innerText === "–") { listz[i].innerText = "" } 
} 
</script>
            </section>

          </div>
        </div>
      </div>
<a href="making-plots-with-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="applying-basic-stats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/darachm/dll-r/edit/main/450-scientific-figures.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DLL 2021 R syllabus site.html"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"highlight": "zenburn"
});
});
</script>

</body>

</html>
