<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.6 Applying basic stats | DLL 2021, R section</title>
  <meta name="description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2.6 Applying basic stats | DLL 2021, R section" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="github-repo" content="darachm/dll-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.6 Applying basic stats | DLL 2021, R section" />
  
  <meta name="twitter:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  

<meta name="author" content="mesako" />
<meta name="author" content="Margaret" />
<meta name="author" content="Samson" />
<meta name="author" content="Zac" />
<meta name="author" content="darachm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="making-scientific-figures.html"/>
<link rel="next" href="appendix.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DLL 2021 R workshops</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workshop Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="workshop-goals.html"><a href="workshop-goals.html"><i class="fa fa-check"></i><b>1.1</b> Workshop goals</a></li>
<li class="chapter" data-level="1.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html"><i class="fa fa-check"></i><b>1.2</b> Structure and resources</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="structure-and-resources.html"><a href="structure-and-resources.html#workshop-schedule"><i class="fa fa-check"></i><b>1.2.1</b> Workshop schedule</a></li>
<li class="chapter" data-level="1.2.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html#asynchronous-sessions"><i class="fa fa-check"></i><b>1.2.2</b> Asynchronous sessions</a></li>
<li class="chapter" data-level="1.2.3" data-path="structure-and-resources.html"><a href="structure-and-resources.html#synchronous-sessions"><i class="fa fa-check"></i><b>1.2.3</b> Synchronous sessions</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="workshop-expectations.html"><a href="workshop-expectations.html"><i class="fa fa-check"></i><b>1.3</b> Workshop expectations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-4---tidyverse-and-visualizations.html"><a href="day-4---tidyverse-and-visualizations.html"><i class="fa fa-check"></i><b>2</b> Day 4 - tidyverse and visualizations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html"><i class="fa fa-check"></i><b>2.1</b> Reading and processing data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html#loading-a-file-into-r"><i class="fa fa-check"></i><b>2.1.1</b> Loading a file into R</a></li>
<li class="chapter" data-level="2.1.2" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html#handling-issues-in-data"><i class="fa fa-check"></i><b>2.1.2</b> Handling issues in data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html"><i class="fa fa-check"></i><b>2.2</b> Tidyverse 1/2: functions &amp; pipes</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>2.2.1</b> Welcome to the tidyverse!</a></li>
<li class="chapter" data-level="2.2.2" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#load-tidyverse"><i class="fa fa-check"></i><b>2.2.2</b> Load tidyverse</a></li>
<li class="chapter" data-level="2.2.3" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#how-to-pipe"><i class="fa fa-check"></i><b>2.2.3</b> How to pipe %&gt;%</a></li>
<li class="chapter" data-level="2.2.4" data-path="tidyverse-12-functions-pipes.html"><a href="tidyverse-12-functions-pipes.html#essential-tidyverse-functions"><i class="fa fa-check"></i><b>2.2.4</b> Essential tidyverse functions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html"><i class="fa fa-check"></i><b>2.3</b> Tidyverse 2/2: reshaping data</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#why-tidy-data"><i class="fa fa-check"></i><b>2.3.1</b> Why tidy data</a></li>
<li class="chapter" data-level="2.3.2" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#how-to-tidy-data"><i class="fa fa-check"></i><b>2.3.2</b> How to tidy data</a></li>
<li class="chapter" data-level="2.3.3" data-path="tidyverse-22-reshaping-data.html"><a href="tidyverse-22-reshaping-data.html#data-exploration-with-tidyverse"><i class="fa fa-check"></i><b>2.3.3</b> Data exploration with tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>2.4</b> Making plots with ggplot2</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#getting-started-with-a-ggplot"><i class="fa fa-check"></i><b>2.4.1</b> Getting started with a ggplot</a></li>
<li class="chapter" data-level="2.4.2" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#changing-plot-aesthetics"><i class="fa fa-check"></i><b>2.4.2</b> Changing plot aesthetics</a></li>
<li class="chapter" data-level="2.4.3" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#exploring-simple-plots"><i class="fa fa-check"></i><b>2.4.3</b> Exploring simple plots</a></li>
<li class="chapter" data-level="2.4.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#visualizing-between-groups"><i class="fa fa-check"></i><b>2.4.4</b> Visualizing between groups</a></li>
<li class="chapter" data-level="2.4.5" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#generating-heatmaps-optional"><i class="fa fa-check"></i><b>2.4.5</b> Generating heatmaps (OPTIONAL)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html"><i class="fa fa-check"></i><b>2.5</b> Making scientific figures</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#plotting-error-bars"><i class="fa fa-check"></i><b>2.5.1</b> Plotting error bars</a></li>
<li class="chapter" data-level="2.5.2" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#showing-trends-in-data"><i class="fa fa-check"></i><b>2.5.2</b> Showing trends in data</a></li>
<li class="chapter" data-level="2.5.3" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#saving-figures-locally"><i class="fa fa-check"></i><b>2.5.3</b> Saving figures locally</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html"><i class="fa fa-check"></i><b>2.6</b> Applying basic stats</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#describing-quantitative-variables"><i class="fa fa-check"></i><b>2.6.1</b> Describing quantitative variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#finding-differences-in-data"><i class="fa fa-check"></i><b>2.6.2</b> Finding differences in data</a></li>
<li class="chapter" data-level="2.6.3" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#identifying-correlations"><i class="fa fa-check"></i><b>2.6.3</b> Identifying correlations</a></li>
<li class="chapter" data-level="2.6.4" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html#producing-linear-models"><i class="fa fa-check"></i><b>2.6.4</b> Producing linear models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>3</b> Appendix</a>
<ul>
<li class="chapter" data-level="3.1" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html"><i class="fa fa-check"></i><b>3.1</b> Some links and some extras</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html#ideas-for-figures"><i class="fa fa-check"></i><b>3.1.1</b> Ideas for figures</a></li>
<li class="chapter" data-level="3.1.2" data-path="some-links-and-some-extras.html"><a href="some-links-and-some-extras.html#more-links"><i class="fa fa-check"></i><b>3.1.2</b> More links</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DLL 2021, R section</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="applying-basic-stats" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Applying basic stats<a href="applying-basic-stats.html#applying-basic-stats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Following up on our analysis using visualizations, we will review different types of statistical tests that we can perform on data. We will again revisit the mammalian sleep dataset <code>msleep</code>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="applying-basic-stats.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(msleep)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 11
##   name    genus vore  order conservation sleep_total sleep_rem sleep_cycle awake
##   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
## 1 Cheetah Acin… carni Carn… lc                  12.1      NA        NA      11.9
## 2 Owl mo… Aotus omni  Prim… &lt;NA&gt;                17         1.8      NA       7  
## 3 Mounta… Aplo… herbi Rode… nt                  14.4       2.4      NA       9.6
## 4 Greate… Blar… omni  Sori… lc                  14.9       2.3       0.133   9.1
## 5 Cow     Bos   herbi Arti… domesticated         4         0.7       0.667  20  
## 6 Three-… Brad… herbi Pilo… &lt;NA&gt;                14.4       2.2       0.767   9.6
## # … with 2 more variables: brainwt &lt;dbl&gt;, bodywt &lt;dbl&gt;</code></pre>
<hr />
<div id="describing-quantitative-variables" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Describing quantitative variables<a href="applying-basic-stats.html#describing-quantitative-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are several ways to describe quantitative measurements. We might first look at the range of values using the <code>quantile</code> function, which returns the min, max, and median values as well as the 25th and 75th percentiles.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="applying-basic-stats.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(msleep<span class="sc">$</span>brainwt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##      0%     25%     50%     75%    100% 
## 0.00014 0.00290 0.01240 0.12550 5.71200</code></pre>
<p>Note that we are using the setting <code>na.rm = TRUE</code> as an argument to these functions so that it ignores <code>NA</code> values in the data.</p>
<p>You can also directly isolate some of these values using the functions <code>min</code> or <code>max</code>. We might describe the center of our data, that is the mean or the median values using those respective function names.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="applying-basic-stats.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(msleep<span class="sc">$</span>brainwt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.0124</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="applying-basic-stats.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(msleep<span class="sc">$</span>brainwt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.2815814</code></pre>
<p>We might also want to describe the spread in the data, such as the standard deviation or the interquartile range.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="applying-basic-stats.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(msleep<span class="sc">$</span>brainwt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.9764137</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="applying-basic-stats.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(msleep<span class="sc">$</span>brainwt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.1226</code></pre>
<p>Visualizations are a great way to see this information in one picture. We have learned to create a fancier histogram, but the <code>hist</code> function always works for quick viewing (worksheet tasks 3.6.1A and 3.6.1B).</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="applying-basic-stats.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(msleep<span class="sc">$</span>brainwt)</span></code></pre></div>
<p><img src="460-basic-stats_files/figure-html/stats5-1.png" width="672" /></p>
<p>It is clear from this image that the data is skewed towards approaching 0 with a few high outliers.</p>
<hr />
</div>
<div id="finding-differences-in-data" class="section level3 hasAnchor" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Finding differences in data<a href="applying-basic-stats.html#finding-differences-in-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the following statistical tests, we want to determine if measurements of a quantitative variable taken on a certain group of samples are different from similar measurements taken from a different group of samples.</p>
<p>To know if these differences are <strong>statistically significant</strong>, we need to be aware of the uncertainty in our data. Even if we have collect many observations, there is generally noisiness and error in those measurements. Thus, we have uncertainty if the mean value we calculate for a group is in fact the true mean.</p>
<p>We can calculate a confidence interval to describe our guess for the mean in our data. That is, we can identify the mean based on our samples, but also provide an upper or lower bound for where the mean might be (worksheet task 3.6.2A).</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="applying-basic-stats.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(msleep<span class="sc">$</span>brainwt)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  msleep$brainwt
## t = 2.1581, df = 55, p-value = 0.03531
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  0.02009613 0.54306673
## sample estimates:
## mean of x 
## 0.2815814</code></pre>
<p>We use this <code>t.test</code> function because we assume that our data is normally distributed (which is not necessarily always the case) and it has a small sample size. You can see that while the mean for brain weight from this popular is 0.28, the range is fairly large (between 0.2 and 0.54) because of how big the variability is in the data.</p>
<p>If we want to determine if two populations have a difference in their mean values that is statistically significant, we can calculate the t-test between two sets of observations. Let’s look at whether the average time spent awake by mammals who are insectivores is significantly less than those who are not (worksheet task 3.6.2B).</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="applying-basic-stats.html#cb158-1" aria-hidden="true" tabindex="-1"></a>insectivores <span class="ot">&lt;-</span> msleep <span class="sc">%&gt;%</span> </span>
<span id="cb158-2"><a href="applying-basic-stats.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vore <span class="sc">==</span> <span class="st">&quot;insecti&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="applying-basic-stats.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(awake)</span>
<span id="cb158-4"><a href="applying-basic-stats.html#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="applying-basic-stats.html#cb158-5" aria-hidden="true" tabindex="-1"></a>other.mammals <span class="ot">&lt;-</span> msleep <span class="sc">%&gt;%</span> </span>
<span id="cb158-6"><a href="applying-basic-stats.html#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vore <span class="sc">!=</span> <span class="st">&quot;insecti&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-7"><a href="applying-basic-stats.html#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(awake)</span>
<span id="cb158-8"><a href="applying-basic-stats.html#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="applying-basic-stats.html#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(insectivores)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 1
##   awake
##   &lt;dbl&gt;
## 1   4.3
## 2   4.1
## 3   5.9
## 4  15.6
## 5  15.4</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="applying-basic-stats.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(other.mammals)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 1
##   awake
##   &lt;dbl&gt;
## 1  11.9
## 2   7  
## 3   9.6
## 4   9.1
## 5  20  
## 6   9.6</code></pre>
<p>At first, we use tidyverse functions to isolate only the mammals that match the feeding behavior and select only the relevant column, before feeding this data into the <code>t.test</code> function (worksheet tasks 3.6.2C and 3.6.2D).</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="applying-basic-stats.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(insectivores, other.mammals, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  insectivores and other.mammals
## t = -1.7796, df = 4.3091, p-value = 0.0723
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##       -Inf 0.8336811
## sample estimates:
## mean of x mean of y 
##   9.06000  13.86056</code></pre>
<p>These results show a p-value of 0.07, which is not the usual level of significance that most scientists accept (p-value &lt; 0.05).</p>
<p>However, there are numerous feeding behaviors besides insectivore and we may be interested in comparing the multiple categories against each other. We can use ANOVA (analysis of variance) to see how our quantitative variable is affected by the different kinds of feeding behavior (worksheet tasks 3.6.2E and 3.6.2F).</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="applying-basic-stats.html#cb164-1" aria-hidden="true" tabindex="-1"></a>anova.msleep <span class="ot">&lt;-</span> <span class="fu">aov</span>(awake <span class="sc">~</span> vore, <span class="at">data =</span> msleep)</span>
<span id="cb164-2"><a href="applying-basic-stats.html#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova.msleep)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## vore         3  133.7   44.58   2.234 0.0916 .
## Residuals   72 1437.0   19.96                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 7 observations deleted due to missingness</code></pre>
<p>The p-value of 0.09 suggests that there may not be a strongly significant difference in the average time spent awake between these groups.</p>
<hr />
</div>
<div id="identifying-correlations" class="section level3 hasAnchor" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> Identifying correlations<a href="applying-basic-stats.html#identifying-correlations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we are examining the relationship between two quantitative variables, we might be interested in whether they correlate with one another. A positive correlation between x and y means that as x increases so does y. A negative correlation between x and y means that as x increases, y decreases. We can use the base R <code>cor</code> function to calculate the correlation between two numeric vectors.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="applying-basic-stats.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(msleep<span class="sc">$</span>brainwt, msleep<span class="sc">$</span>bodywt)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Notice that we get <code>NA</code> instead of an actual numeric value. Unfortunately there is not an easy setting to have the <code>cor</code> function ignore any <code>NA</code> values. Thus, we need to temporarily remove these values. Let’s first find them with the <code>summary</code> function.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="applying-basic-stats.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(msleep<span class="sc">$</span>bodywt)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##    0.005    0.174    1.670  166.136   41.750 6654.000</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="applying-basic-stats.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(msleep<span class="sc">$</span>brainwt)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
## 0.00014 0.00290 0.01240 0.28158 0.12550 5.71200      27</code></pre>
<p>There are no <code>NA</code> values in the <code>bodywt</code> column, but there are 27 <code>NA</code> values in the <code>brainwt</code> column. Let’s remove those using a helpful function in tidyverse and save the more complete dataset as <code>msleep2</code> (worksheet task 3.6.3A).</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="applying-basic-stats.html#cb172-1" aria-hidden="true" tabindex="-1"></a>msleep2 <span class="ot">&lt;-</span> msleep <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(brainwt)</span>
<span id="cb172-2"><a href="applying-basic-stats.html#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(msleep)</span></code></pre></div>
<pre><code>## [1] 83 11</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="applying-basic-stats.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(msleep2)</span></code></pre></div>
<pre><code>## [1] 56 11</code></pre>
<p>You can see that we dropped 27 rows, corresponding to the mammals for whom brain weight was not measured or available. Now we can try to use the <code>cor</code> function.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="applying-basic-stats.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(msleep2<span class="sc">$</span>brainwt, msleep2<span class="sc">$</span>bodywt)</span></code></pre></div>
<pre><code>## [1] 0.9337822</code></pre>
<p>We can see that the correlation is 0.93, a value very close to 1. This suggests that these variabilities are almost perfectly correlated with each other, which we saw when we plotted these two variables against each other in the prior section.</p>
<p>There are multiple types of correlations. The <code>cor</code> function uses a Pearson correlation by default and can use different methods like Spearman. Let’s explore the difference between these correlations by looking at the relationship between the log value of brain weight and length of sleep cycle.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="applying-basic-stats.html#cb178-1" aria-hidden="true" tabindex="-1"></a>msleep3 <span class="ot">&lt;-</span> msleep <span class="sc">%&gt;%</span> </span>
<span id="cb178-2"><a href="applying-basic-stats.html#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">brainwt_log =</span> <span class="fu">log</span>(brainwt)) <span class="sc">%&gt;%</span> </span>
<span id="cb178-3"><a href="applying-basic-stats.html#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(brainwt_log, sleep_cycle)</span>
<span id="cb178-4"><a href="applying-basic-stats.html#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(msleep3, <span class="fu">aes</span>(<span class="at">x =</span> brainwt_log, <span class="at">y =</span> sleep_cycle)) <span class="sc">+</span> </span>
<span id="cb178-5"><a href="applying-basic-stats.html#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="460-basic-stats_files/figure-html/stats13a-1.png" width="672" /></p>
<p>When we plot these variables against each other, including a fitted linear trend line, we can see that there is a relationship between these variables (worksheet task 3.6.3B). However, the points do not quite fit a straight line if we look at the edges and center of this fitted line. This will reflect in our calculation of two different correlations (worksheet task 3.6.3C).</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="applying-basic-stats.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(msleep3<span class="sc">$</span>brainwt_log, msleep3<span class="sc">$</span>sleep_cycle, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.8331014</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="applying-basic-stats.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(msleep3<span class="sc">$</span>brainwt_log, msleep3<span class="sc">$</span>sleep_cycle, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.8726893</code></pre>
<p>Pearson correlations are higher when the data fits to a straight line like a trend line. However, Spearman correlations do not require a single slope: as long as one value goes up and the other goes up, these values are considered highly correlated.</p>
<hr />
</div>
<div id="producing-linear-models" class="section level3 hasAnchor" number="2.6.4">
<h3><span class="header-section-number">2.6.4</span> Producing linear models<a href="applying-basic-stats.html#producing-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You may be interested in studying the relationship between one or more variables and some outcome that you care about. To determine if this set of one or more variables are strong predictors of an outcome (some quantitative variable), you can fit a linear model to this data using the <code>lm</code> function.</p>
<p>Here we train a linear model to try to predict brain weight from body weight in the <code>msleep</code> dataset.</p>
<p>Linear models are established with a formula with the format of <code>outcome ~ predictor</code> where we are trying to determine if the predictor is able to help us accurately estimate an outcome (worksheet task 3.6.4A).</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="applying-basic-stats.html#cb184-1" aria-hidden="true" tabindex="-1"></a>my.mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> brainwt <span class="sc">~</span> bodywt, <span class="at">data =</span> msleep2)</span>
<span id="cb184-2"><a href="applying-basic-stats.html#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my.mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = brainwt ~ bodywt, data = msleep2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.78804 -0.08422 -0.07634 -0.02839  2.06190 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 8.592e-02  4.821e-02   1.782   0.0804 .  
## bodywt      9.639e-04  5.027e-05  19.176   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3526 on 54 degrees of freedom
## Multiple R-squared:  0.8719, Adjusted R-squared:  0.8696 
## F-statistic: 367.7 on 1 and 54 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>In the summary of the results of this modeling, we see that <code>bodywt</code> is a significant predictor of <code>brainwt</code> in the <code>msleep</code> dataset. We can provide more predictors into our formula in the format: <code>outcome ~ predictor1 + predictor2 + ...</code> (worksheet tasks 3.6.4B and 3.6.4C).</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="applying-basic-stats.html#cb186-1" aria-hidden="true" tabindex="-1"></a>my.mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> sleep_total <span class="sc">~</span> bodywt <span class="sc">+</span> brainwt, <span class="at">data =</span> msleep2)</span>
<span id="cb186-2"><a href="applying-basic-stats.html#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my.mod2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sleep_total ~ bodywt + brainwt, data = msleep2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.4531 -2.2517 -0.2619  2.0531  9.2283 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 10.6722485  0.5898643  18.093   &lt;2e-16 ***
## bodywt       0.0007953  0.0016703   0.476    0.636    
## brainwt     -2.3518943  1.6180072  -1.454    0.152    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.193 on 53 degrees of freedom
## Multiple R-squared:  0.1337, Adjusted R-squared:  0.101 
## F-statistic: 4.088 on 2 and 53 DF,  p-value: 0.02232</code></pre>
<p>These results suggest that neither <code>bodywt</code> nor <code>brainwt</code> are significant predictors of <code>sleep_total</code>. That means that the value of either of those measurements does not give us information that helps us guess the total sleep duration for a mammal accurately.</p>

</div>
</div>
<!-- </div> -->
<p style="margin-top:10em;text-align:center;font-size:small;">
    <a href="https://github.com/darachm/dll-r/blob/main/LICENSE.md">
        Licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0
    </a>
</p>
<p style="text-align:center;font-size:small;">
    <a href="https://github.com/rstudio/bookdown" target="blank">
        Website typeset with bookdown
    </a>
</p>

<script> 
// This is to look through, everything that's a floating lone double dash,
// delete it. This is left over for stuff that's trying to be pauses for
// the slides
var listz = document.getElementsByTagName("p");
for (var i=0; i < listz.length; i++) { 
    if (listz[i].innerText === "–") { listz[i].innerText = "" } 
} 
</script>
            </section>

          </div>
        </div>
      </div>
<a href="making-scientific-figures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/darachm/dll-r/edit/main/460-basic-stats.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DLL 2021 R syllabus site.html"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"highlight": "zenburn"
});
});
</script>

</body>

</html>
